<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Benedikt Zacher" />

<meta name="date" content="2025-10-10" />

<title>Excess count detection for epidemiological time series</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>
<script>$(document).ready(function(){
    if (typeof $('[data-toggle="tooltip"]').tooltip === 'function') {
        $('[data-toggle="tooltip"]').tooltip();
    }
    if ($('[data-toggle="popover"]').popover === 'function') {
        $('[data-toggle="popover"]').popover();
    }
});
</script>
<style type="text/css">
.lightable-minimal {
border-collapse: separate;
border-spacing: 16px 1px;
width: 100%;
margin-bottom: 10px;
}
.lightable-minimal td {
margin-left: 5px;
margin-right: 5px;
}
.lightable-minimal th {
margin-left: 5px;
margin-right: 5px;
}
.lightable-minimal thead tr:last-child th {
border-bottom: 2px solid #00000050;
empty-cells: hide;
}
.lightable-minimal tbody tr:first-child td {
padding-top: 0.5em;
}
.lightable-minimal.lightable-hover tbody tr:hover {
background-color: #f5f5f5;
}
.lightable-minimal.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-classic {
border-top: 0.16em solid #111111;
border-bottom: 0.16em solid #111111;
width: 100%;
margin-bottom: 10px;
margin: 10px 5px;
}
.lightable-classic tfoot tr td {
border: 0;
}
.lightable-classic tfoot tr:first-child td {
border-top: 0.14em solid #111111;
}
.lightable-classic caption {
color: #222222;
}
.lightable-classic td {
padding-left: 5px;
padding-right: 5px;
color: #222222;
}
.lightable-classic th {
padding-left: 5px;
padding-right: 5px;
font-weight: normal;
color: #222222;
}
.lightable-classic thead tr:last-child th {
border-bottom: 0.10em solid #111111;
}
.lightable-classic.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-classic.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-classic-2 {
border-top: 3px double #111111;
border-bottom: 3px double #111111;
width: 100%;
margin-bottom: 10px;
}
.lightable-classic-2 tfoot tr td {
border: 0;
}
.lightable-classic-2 tfoot tr:first-child td {
border-top: 3px double #111111;
}
.lightable-classic-2 caption {
color: #222222;
}
.lightable-classic-2 td {
padding-left: 5px;
padding-right: 5px;
color: #222222;
}
.lightable-classic-2 th {
padding-left: 5px;
padding-right: 5px;
font-weight: normal;
color: #222222;
}
.lightable-classic-2 tbody tr:last-child td {
border-bottom: 3px double #111111;
}
.lightable-classic-2 thead tr:last-child th {
border-bottom: 1px solid #111111;
}
.lightable-classic-2.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-classic-2.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-material {
min-width: 100%;
white-space: nowrap;
table-layout: fixed;
font-family: Roboto, sans-serif;
border: 1px solid #EEE;
border-collapse: collapse;
margin-bottom: 10px;
}
.lightable-material tfoot tr td {
border: 0;
}
.lightable-material tfoot tr:first-child td {
border-top: 1px solid #EEE;
}
.lightable-material th {
height: 56px;
padding-left: 16px;
padding-right: 16px;
}
.lightable-material td {
height: 52px;
padding-left: 16px;
padding-right: 16px;
border-top: 1px solid #eeeeee;
}
.lightable-material.lightable-hover tbody tr:hover {
background-color: #f5f5f5;
}
.lightable-material.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-material.lightable-striped tbody td {
border: 0;
}
.lightable-material.lightable-striped thead tr:last-child th {
border-bottom: 1px solid #ddd;
}
.lightable-material-dark {
min-width: 100%;
white-space: nowrap;
table-layout: fixed;
font-family: Roboto, sans-serif;
border: 1px solid #FFFFFF12;
border-collapse: collapse;
margin-bottom: 10px;
background-color: #363640;
}
.lightable-material-dark tfoot tr td {
border: 0;
}
.lightable-material-dark tfoot tr:first-child td {
border-top: 1px solid #FFFFFF12;
}
.lightable-material-dark th {
height: 56px;
padding-left: 16px;
padding-right: 16px;
color: #FFFFFF60;
}
.lightable-material-dark td {
height: 52px;
padding-left: 16px;
padding-right: 16px;
color: #FFFFFF;
border-top: 1px solid #FFFFFF12;
}
.lightable-material-dark.lightable-hover tbody tr:hover {
background-color: #FFFFFF12;
}
.lightable-material-dark.lightable-striped tbody tr:nth-child(even) {
background-color: #FFFFFF12;
}
.lightable-material-dark.lightable-striped tbody td {
border: 0;
}
.lightable-material-dark.lightable-striped thead tr:last-child th {
border-bottom: 1px solid #FFFFFF12;
}
.lightable-paper {
width: 100%;
margin-bottom: 10px;
color: #444;
}
.lightable-paper tfoot tr td {
border: 0;
}
.lightable-paper tfoot tr:first-child td {
border-top: 1px solid #00000020;
}
.lightable-paper thead tr:last-child th {
color: #666;
vertical-align: bottom;
border-bottom: 1px solid #00000020;
line-height: 1.15em;
padding: 10px 5px;
}
.lightable-paper td {
vertical-align: middle;
border-bottom: 1px solid #00000010;
line-height: 1.15em;
padding: 7px 5px;
}
.lightable-paper.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-paper.lightable-striped tbody tr:nth-child(even) {
background-color: #00000008;
}
.lightable-paper.lightable-striped tbody td {
border: 0;
}
</style>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Excess count detection for epidemiological
time series</h1>
<h4 class="author">Benedikt Zacher</h4>
<h4 class="date">2025-10-10</h4>



<p><strong>Ex</strong>cess <strong>c</strong>ount
<strong>de</strong>tection (<em>excode</em>) in epidemiological time
series is an important part of public health surveillance systems. A
variety of algorithms has been developed to identify events such as
disease outbreaks or excess mortality. To this end, time series are
analysed to detect unusually large (case) counts, that exceed what is
normally expected in a certain time period and geographical region. The
normal expectancy of cases in a current time period is usually
calculated based on historic data. Depending on the time series of
interest, the following features need to be taken into account by a
model:</p>
<ul>
<li><strong>Seasonal patterns:</strong> Many epidemiological times
series that are of public health interest show periodic changes in cases
depending on seasons or other calendar periods.</li>
<li><strong>Long-term time trends:</strong> The time series may show a
long-term increase or decrease in case counts.</li>
<li><strong>Historic events:</strong> Events such as disease outbreaks
may have caused an excess of case counts in historic data that is used
for model estimation. This needs to be considered to avoid
overestimation of the normal expectancy for the current time
period.</li>
</ul>
<p>The <em>excode</em> package provides a flexible framework that
implements well established approaches to control for seasonality,
long-term trends and historic events, but also allows the use of
customized models. The user can choose between the Poisson and the
Negative Binomial distribution, which are the most commonly used
probability distributions for modeling count data. By combining hidden
Markov models and generalized linear models, <em>excode</em> explicitly
models normally expected case counts <em>and</em> expected excess case
counts, i.e. each time point in a time series is labeled either as a
normal state or as an excess state. A short overview of the statistical
model used can be found at the end of this document.</p>
<div id="overwiew-of-available-models-in-excode" class="section level2">
<h2>Overwiew of available models in <em>excode</em></h2>
<p>There are four different model classes implemented in
<em>excode</em>:</p>
<ul>
<li><strong>Mean:</strong> This model does not account for seasonal or
cyclical patterns. The expectancy of normal and excess case counts is
modeled as the mean of the historic data.</li>
<li><strong>FarringtonNoufaily:</strong> This is a popular algorithm,
which models seasonality by segmenting a year into a predefined number
of shorter time periods, where each has a different expectancy of
observed cases. It also allows integration of a long-term time
trend.</li>
<li><strong>Harmonic:</strong> The ‘Harmonic’ model uses sine and cosine
function to account for seasonal or cyclical patterns in the data. It
also allows integration of long-term time trends.</li>
<li><strong>Custom:</strong> The ‘Custom’ model allows the user define
their own model by providing a data frame containing covariate
data.</li>
</ul>
<p>All of the above mentioned models use one ‘normal’ and one or more
‘excess’ states. In order to detect potential disease outbreaks, two
states are sufficient in most scenarios. However in some cases it might
be necessary to allow multiple states, such as ‘normal’, ‘low excess’,
‘medium excess’, ‘high excess’, to account for a wide range of excess
counts and detect all periods showing an excess in a time series.</p>
<p>The time trends are: * <strong>None</strong>: *
<strong>Linear</strong>: * <strong>Spline(1-4)</strong>:</p>
</div>
<div id="using-excode-for-excess-count-detection" class="section level2">
<h2>Using <em>excode</em> for excess count detection</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(excode)</span></code></pre></div>
<p>The input data is a <code>data.frame</code> with at least two
variables containing dates and the observed number of cases:</p>
<ul>
<li><strong>date</strong>: The date of the event (e.g. reporting date,
date of disease onset, date of death)<br />
</li>
<li><strong>observed</strong>: The observed number of cases.</li>
</ul>
<p>Optional variables can be:</p>
<ul>
<li><strong>offset</strong> (optional): This could be e.g. the
susceptible population.</li>
<li><strong>state</strong> (optional): This can used to indicate time
points in the data where there is no excess and can be either
<code>0=normal</code> or <code>NA=unknown</code>.</li>
</ul>
<p>The example data <code>shadar_df</code> in this section contains the
number of weekly cases of <em>Salmonella hadar</em> from 2001 until 2006
in Germany (taken from the <a href="https://cran.r-project.org/web/packages/surveillance/index.html">surveillance
package</a>). This dataset does not contain an <strong>offset</strong>
and <strong>state</strong> variable as we do not adjust for population
size and the true disease outbreak labels are not included.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="do">## Load data and show first 6 rows</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;shadar_df&quot;</span>)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">as_tibble</span>(shadar_df[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, ])) <span class="sc">%&gt;%</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">11</span>)</span></code></pre></div>
<table class="table" style="font-size: 11px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
date
</th>
<th style="text-align:right;">
observed
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
2001-01-08
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
2001-01-15
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:left;">
2001-01-22
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
2001-01-29
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
2001-02-05
</td>
<td style="text-align:right;">
15
</td>
</tr>
<tr>
<td style="text-align:left;">
2001-02-12
</td>
<td style="text-align:right;">
5
</td>
</tr>
</tbody>
</table>
<p>In this example, the ‘Poisson’ distribution and the ‘Harmonic’ model
is chosen to account for the seasonal patterns and long-term time trend.
Excess count detection is carried using the <code>run_excode()</code>
function. If time points with excess is expected to be rare (e.g. for
disease outbreak detection) it is recommended to set
<code>set_baseline_state = TRUE</code>. This assigns low case counts to
the <code>normal</code> state and improves model fitting.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>result_shadar_har <span class="ot">&lt;-</span> <span class="fu">run_excode</span>(</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>    <span class="at">surv_ts =</span> shadar_df,</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>    <span class="at">timepoints =</span> <span class="dv">209</span><span class="sc">:</span><span class="dv">295</span>,</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>    <span class="at">distribution =</span> <span class="st">&quot;Poisson&quot;</span>,</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>    <span class="at">states =</span> <span class="dv">2</span>,</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>    <span class="at">periodic_model =</span> <span class="st">&quot;Harmonic&quot;</span>,</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>    <span class="at">time_trend =</span> <span class="st">&quot;Linear&quot;</span>,</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>    <span class="at">return_full_model =</span> <span class="cn">FALSE</span>, </span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>    <span class="at">set_baseline_state =</span> <span class="cn">TRUE</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>)</span></code></pre></div>
<p>Results can be extracted using the <code>summary()</code>
function:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>summary_shadar_har <span class="ot">&lt;-</span> <span class="fu">summary</span>(result_shadar_har)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">as_tibble</span>(summary_shadar_har[<span class="dv">82</span><span class="sc">:</span><span class="dv">87</span>, ])) <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">11</span>)</span></code></pre></div>
<table class="table" style="font-size: 11px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
posterior0
</th>
<th style="text-align:right;">
posterior1
</th>
<th style="text-align:right;">
pval
</th>
<th style="text-align:right;">
zscore
</th>
<th style="text-align:left;">
date
</th>
<th style="text-align:right;">
timepoint
</th>
<th style="text-align:right;">
observed
</th>
<th style="text-align:right;">
mu0
</th>
<th style="text-align:right;">
mu1
</th>
<th style="text-align:right;">
BIC
</th>
<th style="text-align:right;">
AIC
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.015
</td>
<td style="text-align:right;">
0.985
</td>
<td style="text-align:right;">
0.002
</td>
<td style="text-align:right;">
2.99
</td>
<td style="text-align:left;">
2006-07-24
</td>
<td style="text-align:right;">
290
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
3.29
</td>
<td style="text-align:right;">
10.9
</td>
<td style="text-align:right;">
1117
</td>
<td style="text-align:right;">
1034
</td>
</tr>
<tr>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
4.84
</td>
<td style="text-align:left;">
2006-07-31
</td>
<td style="text-align:right;">
291
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
3.61
</td>
<td style="text-align:right;">
11.9
</td>
<td style="text-align:right;">
1127
</td>
<td style="text-align:right;">
1043
</td>
</tr>
<tr>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
6.17
</td>
<td style="text-align:left;">
2006-08-07
</td>
<td style="text-align:right;">
292
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
3.86
</td>
<td style="text-align:right;">
12.9
</td>
<td style="text-align:right;">
1138
</td>
<td style="text-align:right;">
1054
</td>
</tr>
<tr>
<td style="text-align:right;">
0.290
</td>
<td style="text-align:right;">
0.710
</td>
<td style="text-align:right;">
0.036
</td>
<td style="text-align:right;">
1.93
</td>
<td style="text-align:left;">
2006-08-14
</td>
<td style="text-align:right;">
293
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
3.72
</td>
<td style="text-align:right;">
12.4
</td>
<td style="text-align:right;">
1141
</td>
<td style="text-align:right;">
1058
</td>
</tr>
<tr>
<td style="text-align:right;">
0.045
</td>
<td style="text-align:right;">
0.955
</td>
<td style="text-align:right;">
0.001
</td>
<td style="text-align:right;">
3.29
</td>
<td style="text-align:left;">
2006-08-21
</td>
<td style="text-align:right;">
294
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
3.92
</td>
<td style="text-align:right;">
12.9
</td>
<td style="text-align:right;">
1153
</td>
<td style="text-align:right;">
1070
</td>
</tr>
<tr>
<td style="text-align:right;">
0.867
</td>
<td style="text-align:right;">
0.133
</td>
<td style="text-align:right;">
0.188
</td>
<td style="text-align:right;">
1.03
</td>
<td style="text-align:left;">
2006-08-28
</td>
<td style="text-align:right;">
295
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
3.83
</td>
<td style="text-align:right;">
12.4
</td>
<td style="text-align:right;">
1149
</td>
<td style="text-align:right;">
1066
</td>
</tr>
</tbody>
</table>
<p>The result is a <code>data.frame</code> with the following
variables:</p>
<ul>
<li><strong>posterior0:</strong> Probability for the <code>normal</code>
state the current time point.</li>
<li><strong>posterior1:</strong> Probability that there is an
<code>excess</code> of case counts at the current time point.</li>
<li><strong>pval:</strong> P-value for the null hypothesis that there is
no excess at the current timepoint.</li>
<li><strong>zscore:</strong> Measures how many standard deviations the
observed number of cases is from the mu0. A value of <code>2.33</code>
corresponds to a p-value of <code>0.01</code>.</li>
<li><strong>date:</strong> The event date (e.g. reporting date or date
of disease onset).</li>
<li><strong>timepoint:</strong> Timepoint (as integer) in the time
series.</li>
<li><strong>observed:</strong> Number of cases at the current time
point.</li>
<li><strong>mu0:</strong> Number of expected cases under normal
conditions.</li>
<li><strong>mu1:</strong> Number of expected cases under excess
conditions.</li>
<li><strong>id:</strong> Name of the time series.</li>
<li><strong>BIC:</strong> Bayesian information criterion.</li>
<li><strong>AIC:</strong> Aikake information criterion.</li>
</ul>
<p>The result summary can visualised using the
<code>plot_excode_summary()</code> function. Figure 1 shows that there
is a cyclical pattern of case counts, with more cases during the summer
and fewer cases cases during the winter There is also a decrease of
reported cases over the years, except for the year 2006, <a href="https://www.rki.de/DE/Content/Infekt/EpidBull/Archiv/2006/Ausgabenlinks/31_06.pdf?__blob=publicationFile">where
an outbreak lead to a surge in case numbers compared to previous
years</a>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co">#plot_excode_summary(summary_shadar_har, type=&quot;bar&quot;)</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">plot_excode_summary</span>(<span class="fu">bind_rows</span>(shadar_df <span class="sc">%&gt;%</span> </span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>                                dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>date <span class="sc">%in%</span> summary_shadar_har<span class="sc">$</span>date <span class="sc">&amp;</span> </span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>                                                lubridate<span class="sc">::</span><span class="fu">year</span>(shadar_df<span class="sc">$</span>date)<span class="sc">&gt;=</span><span class="dv">2003</span>), </span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>                              summary_shadar_har) <span class="sc">%&gt;%</span> </span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>                                <span class="fu">mutate</span>(<span class="at">posterior0=</span><span class="fu">ifelse</span>(<span class="fu">is.na</span>(posterior0), <span class="dv">1</span>, posterior0),</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>                                       <span class="at">zscore=</span><span class="fu">ifelse</span>(<span class="fu">is.na</span>(zscore), <span class="dv">0</span>, zscore),</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>                                        <span class="at">pval=</span><span class="fu">ifelse</span>(<span class="fu">is.na</span>(pval), <span class="dv">1</span>, pval))</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>                    , <span class="at">type=</span><span class="st">&quot;bar&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img role="img" aria-label="**Figure 1:** Weekly *Salmonella Hadar* cases with alarm thresholds (upper bounds)." src="data:image/png;base64,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" alt="**Figure 1:** Weekly *Salmonella Hadar* cases with alarm thresholds (upper bounds)." />
<p class="caption">
<strong>Figure 1:</strong> Weekly <em>Salmonella Hadar</em> cases with
alarm thresholds (upper bounds).
</p>
</div>
<p>Models ‘Mean’ and ‘FarringtonNoufaily’ can be applied likewise.</p>
</div>
<div id="the-custom-model" class="section level2">
<h2>The ‘Custom’ model</h2>
<p>The ‘Custom’ model can be used to fit a model with covariate data
selected by the user. To give an example, data of <a href="https://robert-koch-institut.github.io/SARS-CoV-2-Infektionen_in_Deutschland/">SARS-CoV-2
infections in Berlin-Neukölln (Germany)</a> from March-July 2020 will be
used (downloaded on 2024-10-31). Figure 4 shows that after an inital
peak of infections in late March/early April, the number of infections
dropped, showing only few cases in May, followed by a rise in June which
could be attributed to several <a href="https://www.berlin.de/ba-neukoelln/aktuelles/pressemitteilungen/2020/pressemitteilung.950143.php">local
outbreaks</a>. The daily number of reported SARS-CoV-2 differs over the
course of a week, showing higher number of cases reported during
weekdays and lower number of cases during weekends. In the following a
‘Custom’ <code>excodeModel</code> is used, that models the mean number
of reported cases during the past 8 weeks on workdays and weekends, to
detect the observed local outbreaks. To define the necessary covariate
data for the model, a <code>data.frame</code> - <code>weekday</code> -
is created, indicating whether a current day is a workday or
weekend:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">data</span>(sarscov2_df)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>num_wday <span class="ot">&lt;-</span> <span class="fu">wday</span>(sarscov2_df<span class="sc">$</span>date, <span class="at">week_start =</span> <span class="dv">1</span>)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>weekday <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">day =</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(num_wday <span class="sc">&lt;=</span> <span class="dv">5</span>, <span class="st">&quot;workday&quot;</span>, <span class="st">&quot;weekend&quot;</span>),</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>  <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;workday&quot;</span>, <span class="st">&quot;weekend&quot;</span>)</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>))</span></code></pre></div>
<p>This is then used to create the ‘Custom’ <code>excodeModel</code>
object. Note that <code>timepoints_per_unit = 7</code> indicates that
the repeating time periods are weeks (by default this is 52, i.e. yearly
periodic data). After this, the model is fitted, taking into account 8
weeks of historic data (<code>time_units_back = 8</code>) and excluding
the past two days for fitting
(<code>past_timepoints_not_included = 2</code>).</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>result_sarscov2_custom <span class="ot">&lt;-</span> <span class="fu">run_excode</span>(</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>    <span class="at">surv_ts =</span> sarscov2_df,</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>    <span class="at">covariate_df =</span> weekday,</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>    <span class="at">states =</span> <span class="dv">2</span>,</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>    <span class="at">distribution =</span> <span class="st">&quot;Poisson&quot;</span>,</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>    <span class="at">periodic_model =</span> <span class="st">&quot;Custom&quot;</span>,</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>    <span class="at">timepoints =</span> <span class="dv">93</span><span class="sc">:</span><span class="dv">154</span>,</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>    <span class="at">time_units_back =</span> <span class="dv">8</span>,</span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>    <span class="at">period_length =</span> <span class="dv">7</span>,</span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>    <span class="at">return_full_model =</span> <span class="cn">FALSE</span>, </span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a>    <span class="at">set_baseline_state =</span> <span class="cn">TRUE</span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a>)</span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a>summary_sarscov2_custom <span class="ot">&lt;-</span> <span class="fu">summary</span>(result_sarscov2_custom)</span></code></pre></div>
<p>The results can be plotted as follows:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">plot_excode_summary</span>(<span class="fu">bind_rows</span>(sarscov2_df <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>date <span class="sc">%in%</span>summary_sarscov2_custom<span class="sc">$</span>date), summary_sarscov2_custom), <span class="at">type=</span><span class="st">&quot;bar&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img role="img" aria-label="**Figure 2:** Daily reported SARS-CoV-2 infections in Berlin-Neukölln with alarm thresholds (upper bounds)." src="data:image/png;base64,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" alt="**Figure 2:** Daily reported SARS-CoV-2 infections in Berlin-Neukölln with alarm thresholds (upper bounds)." />
<p class="caption">
<strong>Figure 2:</strong> Daily reported SARS-CoV-2 infections in
Berlin-Neukölln with alarm thresholds (upper bounds).
</p>
</div>
</div>
<div id="initialisation-with-known-normal-states" class="section level2">
<h2>Initialisation with known <code>normal</code> states</h2>
<p>The ‘MultiState’ model allows multiple states, which can be necessary
if the use of only one excess state is not sufficient to model the data.
This can be the case when the range of excess counts is very large. To
illustrate application of the ‘MultiState’ model, weekly all-cause
mortality data reported to the <a href="https://www.destatis.de/DE/Themen/Gesellschaft-Umwelt/Bevoelkerung/Sterbefaelle-Lebenserwartung/sterbefallzahlen.html">German
Federal Statistical Office</a> is used (Figure 5). The ‘MultiState’
model with four states is applied to detect weeks with excess mortality
in the time series.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;mort_df_germany&quot;</span>)</span></code></pre></div>
<p>For models with only two states, <em>excode</em> automatically
initializes and fits the model. However, when using multiple states,
initialization of the GLM part of the model needs to be done manually.
In order to do so, initial estimates for the expected number of cases
for each state need to be provided. First the baseline number of deaths
is estimated, which roughly follows the <a href="https://www.euromomo.eu/graphs-and-maps">EuroMOMO</a> protocol.
The baseline fit uses sine and cosine functions to control for
seasonality as well as a linear time trend. To avoid overestimation of
the expected background mortality, only weeks 15 to 26 (spring) and 36
to 45 (autumn) are included to estimate the background model, since
these are time periods where no excess mortality is expected. All
necessary variables are stored in <code>mort_df_germany</code>:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">as_tibble</span>(mort_df_germany[<span class="dv">15</span><span class="sc">:</span><span class="dv">20</span>, ])) <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">11</span>)</span></code></pre></div>
<table class="table" style="font-size: 11px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
date
</th>
<th style="text-align:right;">
observed
</th>
<th style="text-align:right;">
state
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
2016-04-10
</td>
<td style="text-align:right;">
18242
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2016-04-17
</td>
<td style="text-align:right;">
17710
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
2016-04-24
</td>
<td style="text-align:right;">
16774
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
2016-05-01
</td>
<td style="text-align:right;">
17050
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
2016-05-08
</td>
<td style="text-align:right;">
16899
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
2016-05-15
</td>
<td style="text-align:right;">
17629
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<p><em>excode</em> models the mean of the excess states as
multiplicative increase compared to the mean of the normal/background
state. Initial estimates for the mean of each excess state are chosen as
the 75%-, 85%-, and 95%-quantile of the relative increase of the
observed number of deaths compared to the estimated baseline, which
corresponds to a 6%, 10% and 21% increase:</p>
<p>The ‘MultiState’ model can now be fitted using
<code>run_excode()</code> as usual:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>result_mort <span class="ot">&lt;-</span> <span class="fu">run_excode</span>(</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>    <span class="at">surv_ts =</span> mort_df_germany,</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>    <span class="at">covariate_df =</span> weekday,</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>    <span class="at">states =</span> <span class="dv">3</span>,</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>    <span class="at">distribution =</span> <span class="st">&quot;NegBinom&quot;</span>,</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>    <span class="at">periodic_model =</span> <span class="st">&quot;Harmonic&quot;</span>,</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>    <span class="at">time_trend =</span> <span class="st">&quot;Spline2&quot;</span>,</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>    <span class="at">timepoints =</span> <span class="fu">nrow</span>(mort_df_germany),</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>    <span class="at">return_full_model =</span> <span class="cn">TRUE</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## No `offset` column; assuming offset = 1 for all rows.</code></pre>
<pre><code>## Additional columns in `surv_ts` will be passed through/ignored as appropriate: id</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>summary_mort <span class="ot">&lt;-</span> <span class="fu">summary</span>(result_mort)</span></code></pre></div>
<p>The results and weekly excess probablities can be plottad as
follows:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">plot_excode_summary</span>(summary_mort)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img role="img" aria-label="**Figure 6:** *Top*: Weekly all-cause mortaility in Germany and expected mortality of the normal and three excess states are shown. Weeks with excess probabilty&gt;0.5 are shown in blue. *Bottom*: Weekly excess probability." src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAJACAMAAABlpiR1AAABsFBMVEUAAAAAADoAAEUAAGYAAIsAOmYAOpAAZrYZGT8ZGWIZP4EZYp8aGhofJy4gIFQuJx8ySnYzMzM6AAA6ADo6AGY6OmY6OpA6kJA6kNs7O6M/GRk/GWI/P4E/gYE/gb1AQKhDVXZNTU1NTV5NTW5NTY5Nbo5NbqtNechNjshWbHNebnNiGRliGT9iGWJiP4FiYp9in9ljTU1kle1mAABmADpmAGZmOgBmZmZmtv9uTU1uTW5uTY5ubo5ubqtuq6tuq+Rutf901XR1dXV5eU1/U1l/f3+BPxmBPz+BP2KBvb2BvdmDTU2Gq+yLsPKOTU2OTW6OTY6Obk2Og02Ojm6Ojo6OyP+O5P+QOgCQOjqQkGaQtpCQ2/+d5P+fYhmfYmKfn2Kf2Z+f2b2f2dmrbk2rbm6rbo6rq26ryKur5OSr5P+t2Oa2ZgC2Zjq2//+9gT+92dm93efC4uzIjk3I/8jI///Zn2LZvYHZvb3Z2Z/Z2b3Z2dnbkDrb/9vb///kq27k/8jk/+Tk///r6+v/Y0f/tW//tmb/yI7/1wD/25D/5Kv//7b//8j//83//9v//+T////hLOklAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAgAElEQVR4nO2dj4Mcx5XX+44hOZ+XkBwQ/AvpFgfjO9vHMsfdRc4ZseGQg5AcB1gSLggS2SFozMmKkHTaNRF4F2u90Vn9L9PVVdX169XPrp6u6nlfezXTPV2v3nR/5tXPrm5aFKpgNXM7gEK5hICiihYCiipaCCiqaCGgqKKFgKKKFgKKKloIKKpoIaCoooWAoooWAooqWggoqmghoKiihYCiihYCiipaCCiqaCGgqKKFgKKKFgKKKloIKKpoIaCoooWAoorWTgL6WdM03+1eP/lu2PFf/TjwQK9+88fN136dyRbRl3//r7KZ+j16UgrTLgL6WcfIb/74pRkAJYY++3oeW0RfNH8rF6C/+Rc/bb/8ez/NZC2flgNo45R04G/+hFxUEns++bM+aHzR9Ne5i27dy5f/4E9JkPvqJz+l22T33/5TGdBDp6QDv/rJf26alzrrL/W5dX8kazXonbvltNZ+8lt/qUbQM6ecxr4gv5vQX+wWtYOAftEXsiSYffK1XzNqSFj75CXy8uXvfbeDs/3y27+m22T3F00aoD8m5r5OLj+joLPahyqhCEANa61RxIcDChnTXCtDywE0WF/QMraLFiRgfPJddlnIS8cquVafdWi+xLYJvolFPAGd/HWWeJj6mg7oGGtteh0UNPbVj19KMjapdhZQAt3//GnPadc8+K2fkqK86V776/Xt/92X8Hw7segzKTAj6BhrbV5A+2p5cdpBQKU66Hd5cOxCG93d7//qJ3/5bb6dNYKaddAx1tqsgHZ1myRTE2sHAW0/69o+tBX/dV7ukj9S2ewrpaQf6qWWbZt10GBJFJCw2WVLCtHUVrxprc0CKDNWKJ87CShpttN+0D8jZXv7ydCK77b6S973t9DtLnxqrfhgSRSQrtd/+Cd/NaYfFLCWBVBm7LO+LVkepDsJKKoeIaCoooWAoooWAooqWggoqmghoKiihYCiihYCiipaCCiqaCGgqKKFgKKKFgKKKloIKKpoIaCoooWAoooWAooqWggoqmghoKiihYCiihYCiipaCCiqaCGgqKKFgKKKFgKKKloIKKpoIaCoooWAoorWHIB+C4VSZYdlFkChnaeTZVej5Sqdhi1/68QvBLQ2y1U6jYCmqUbLVTqNgKapRstVOo2ApqlGy1U6jYCmqUbLVTqNgKapRstVOo2ApqlGy1U6jYCmqUbLVTqNgKapRstTmW4aBNQvBHQ2003TIKBeIaCzmUZAQ4SAzmYaAQ0RAjqbaQQ0RAjobKYR0BAhoLOZRkBDhIDOZhoBDRECOptpBDRECOhsphHQECGgs5lGQEOEgM5mGgENEQI6m+kO0OmuOAKaphotI6BcCGiRlhFQLgS0SMsIKBcCWqRlBJQLAS3SMgLKhYAWaRkB5ZoF0FPUTCKAbjnLGgGFdtYY5zCCKlpOBIV21ogRAqoIAU1TjZYnMt3RiYD6hYDOZRoBDRICOpdpQud0hCKgaarRMgLKhYAWaRkB5UJAi7SMgHIhoEVaRkC5ENAiLSOgXAhokZYRUC4EtEjLCCgXAlqkZQSUCwEt0jICyoWAFmkZAeVCQIu0jIByIaBFWkZAuRDQIi0joFwIaJGWpwX0jCi/dQQ0TTVanhLQM6bs1hHQNNVoeUJAGZsTEIqApqlGy9MBOoCZn1AENE01WqamszPUkPKdX/Ls1hHQNNVomZieoKrY8zlc8tyEIqBpqtFyZ7qHMy+hhE+5mykzoQhommq03J5yeHIi2puS+0HzEoqApqlGyxI6GQntDSkd9VkJRUDTVKNlBZxsFJmAtggoIATUJw3JXIQioGFCQH06OzvVtvNYJVcbAfVqIYBOtxBXR80EgLIeJs3pjIQioGmqDlDCjA5oBoxYD5PudD5CEdA0TQfo6SSE9sSc6vtGY3RmAbRFQHUhoE5BgI6Pc0MXqOF0thCKgKZpEYCOxmhowJtOZ+oiQEATtQxAR2J05gI0TxPsrHRAL67s7x+17ZP9/f3vPGiffbD/xuet9sJchlIjoEwUFwDQURj1iS2A5iD0zOh54CoG0Gc/vNNevHunvX9Etp5/dNQ+eVN74S5DyasEdIobfCgsgNNjKDqbHtDgOujjt/aoXri9VUCfEgDvHz3/+A7Zevbhg/biew/UF+4ylBwBpTqzA5qOEUs6HaCWagmRLYLe3TvYfh20i6JdYU5K+ov3Pidb6gtxl2jLT+qZSOSJQ/mfOnTm+MjxmccoTUm9NX1ONxxgAAb08Vsifm4P0OcfXe1L+S6KPn2jR1J9YYdhBLWLBzPQ6eRIN3UEtUb91hJB7+5d2nodlLSErrJ3949sEbR3GUpcK6CZCeWobBXQsYTaqyUtCKgaPrcG6MWVI/72/tGO1EFzh9CzeQAd24dFX0IBfaiGz20ByvgkpfnzXzwgpX3ffJdfuMtQcgS0lQnMCihP5wB0fBdB8a140v9Jmkfd6+t39A7QBfaDdte5BzQnoVMByl7tgI7rw2KvhfeDhmtJgPKFOvLY9ACaSOhZCKCj+7AQ0FRNC2jWhWR8gKYFuiGRA9ARIdTjM1QHVQt4BHQSUUAZmpkQ9QOakMtZGKAjG2BtRB30QN+FgE4gAujZsBBCFkIlEzanUwAd3rkATSXU6zMF9O7e3sHjt6/3gL5zGwHdgmUG6NCOzzGnWLy1AhqdydnEgIq3DkA7Nh+99mn3fw+r3suEgE4gulBcK3U0jSb0LADQ6BAqG50AUL/P32JRk/5/MnQzYR10Wsv9QnHsDdNYQuXUdkAj84gANMV7v8+0iL916eTWwaNXjcIdAZ0S0FP2hmvklE05HtudjsvjLBjQkQ2w1h1BadQ0ynYEdDLLZCVDHdCRAzLUGjXnADQqD4NPF6Bj6rdt7EgSFvHTWu4AZZYVQtMN8goDw8hxYLxVKg+g4xpgbWRHvdJSQkCziwRQCNBkQof5HH5AI/IwS/jWPkdwQkDNqKl0NiGg2dWIexy05eISDYoJR7Sm6D80wmrLbbczAcqi5ovivdJgqgTQiR4/Qc9b9rWKWxDQ1EL+rEZAtQReQJVupvqK+LOzaQjtz1tuw2dWQMcNyMwJaHwXlrrpBfShVMTXVwed7PETLDa3WRE9ExRlWY2rCECju7DUbX8dVBqEr68OKr5u5iB6OpCZc61iK6BJhbxUwucEVD0yANC4HgJtO6oVX2MddFBeQk/PZPbz2DxrHICO6PAOAjQ8B/U4P6CRPQTajrh+UHlKU22A5gPJsJXH8JkL0KQZR1GAhn6Ls2kB1Xc4Ab3VMfm7n8LRdLcBVU3lWWnzrHUCGp9FJKCBvwHtqLyAmoc6AD2+RtpEd3tC57onKVxBgOarLZ45t5NMtk5AU/prYgENyUE/KAjQ8Pqtscc9m0k0jG71sL5YdQTNRqi56Np4y1MAyt6EAhoUQvVjAgCNqN5GASpDqcBaLaDZKovmomu5AR1fxp8lAOrPwjgkDNBA34HD/N1MfbEuF/cVA5qHUDEgmdHyMI0+H6CtZCkIUH8e5gEDoOfn5+l27YcFdzMZDaYqAc1BqDTek9GyF9DYDLYDKJ/Id86UaNd+1M7ddpylLM5veSjh7YCmDslsA9CeTTuhqYCyu7BNIaBWsfTZAW0DAI3JQBy8BUA7MIc3SXYtRzX9SkCATECPry2jiC8U0LMQQKNCqDiWAdow02PqipYqKDEph9J4w8BBTT+DIBTQrpF0/P71+htJxQJK/vEDmtTjTS0xQN11RV8O5qfEbGdOtOJtMTTO55bOsnYDKk9YfvzO7Q7Q6ruZiMY3ZvJbPgsDNGZGh3grA+qpK3pyAD7szBJjcjdTagg1xlB9gFLRKXbH1w4WEkGTRrXl1HZA0wml6fyABudwBgIqwHQQ6nVTUQ+o1g8KE+p2GBqiCgOURc1Hr/782iLqoBla21bL6TPf+5ecgErvB0DlwJnS4IY+aprejtpRnxRCzeZXGKALvC9+bGPGYTnJtDxmngfQMwhQFcl4QsEPOrPkRQM0gVCgfyCwDrq8++JHhNAhpaXHpgxA9dYGfSFNGVnWXvUQo4PxcwaoN4S6z42lfyC4Drqs++LT64peQFMsKyX8YHlEKwkEtG/KyIob9rGMpzMjOqCxIRRufgUBKrfc2UJiZQIa9Qie1Ef3+I9IMK08cGgQ/LSkIPvqQdTQ+bluj/QOBSTn++CMhVXFX9B03NOaenu2R0ZZ6qCL6GYiSgyhUrKMls8iImhYBkAEJUM9ejSyD50HZ9uZ7V9PdX8jQ2hSBAVu81hGHbRNbSdJqbICSl/DAA1xHQQUuNgRhbytgG9sgMYROqKIt6puQEfUFZ2W4w2fxQIa2aPIB8mhix1MqK0G2toABU07OggsgOoNOy4KqDn+vhhAx0Q6t+Vow+qsIz+gAV3eypYEqGnR2tV05tweUnOTJqCQadu5Ac3TjltXBAUmKe8yoGoKh+VUu8GAxs3o4CU8bNEaQs+UDVsLPhZQ2HVLD6sPUOU2j8XMZmKaENBIyzZAk0OoMWTIYQEB9RPq4DMSUAuhlh5WPkYFyYigS7nlY9B0gCYv9RIOaFSXdw+o3aKD0N6Sfb2LBEBBQp18OicsS1FzITfNCU0JaJRpcXAwoHFd3mw6h9Wik1DX0lMpgAKEWuyzMdTQGfWLi6AjGjM+y3HzilMAjeqv4aHIZtE5f9l1P6YGqGK9kX4Whk3n9mDhPArQxdVBoxsz2nl0Wo4wbfCZH1ABSiygbnkADSTU9lVYAN2ppW9URYZQ7Wjn7T3hls0AWgGgzdAxMBgEAbV0ESguOisQ3LIpSzfTguqgbWQI1U+k23KwaelAFVDXrHd7uZgCaDShDD6l48oEtLWGUMlHVwVX/70qMrqZhkUcXlwQoFF1xRjL4fOKbYC67xyK6VFsvIDa+kJtkqKjB1BHL6u3BWYUKIqMpW94BP3ZOxUvHqYrpqoYB2jKtDjpijA2XYgG9yiGABpHaD+P+DwMUOtAlWdd9vMQQIEV7eRCfgGARtQV4yyPAnSInY377rawHkWJT2utNhbQoQ/IB2hscB4cOlcsm1r8ZBGq8KriFgEVUGq3ERmJg2Z0NFJ6K6BRHBH4zk1AD4nkY4Yh1nidtwgoUUpVMadlCNBzrUQOJxQuMeXk1ufBRXHUAyocpJYPmYZD+CSVCMOyO0GALnk2E1UgodsFVNsTeg+7bcRcuhj2BxZGAsra2MIcYbPb4ohKgCYQanRgmeLdTOJe+L5CKt+StAhAU0AKs5w48V2ZAGki6zJgnREnNgxA+TMSozgigDYKoJRLssUIFYAmEGp2YJni3UzDaiLH18jE+ocLGuqkmgzQxHnFrXxnm/8Sex81IrU22h5QrSQWhPq8lT09VwGVqOw32NvUEBoMqLyayOO3r59U/hgaUNMBmjyvGADU1dnk7rGRKnMtAfRQqSsmBbq+i0kGlFg7VTe3A6iymsijVy6dPKzzMTTu7sQA09BBAYAmzis2APWsR+cC9FwDlJMpx7xYQgWgQwBtZUBbWh3dBqCLaMWPX/oXPMaLvtc2MG2zVWfoDhcpfT6H2rMk+oEOaZzLAWhvkwFKLY4DlPUB882FA8rYHLX2L3iEF31bQlvGw8ALAGhyd6ICaN/SHmzzODce0LZVAG1IRTfFMHdaStu6G0nySNLdvb0DWhGtDVD6Lp1Q+AA/+h7T1nnFMqDjCFW6a0TRy2xzXBsxOckQ1C3VDGZZuBycHgBtDuXUca5rATQ0gnZsPnrt06JXFoF2yt/OSqjbroWyAPSdhIIT36llZR/XeEBJU0YGtJEAtREK3QjaDFVE2q8kOS0ATQ+h+t1ToYC+c5v+Xy+g/slf8MfwbtlYAqGOWUcWQMd2eNOmDN9sBEZDPoGADm0YGkBbyWkGKMtNNPIifVYACq2D3rp0cuug8m4mpdNayF0SW7pvztWtyDYYNOsImKEr45FAqApoawDayCOTYA4goDx4SgFUArQRNVPRCxHlsvq9QyOouRRjfYA28THUyue5c9tnGdg/WFAAHUWo3EY6lAHlRXF76KksAoCey4AOMVgGdMgvoRdC5/PQD6hSrJ/UDqjlLhmbUTufp8YemoX61UcCOi6EGgEUAtRdWTQB5aUQLcuH2UunYucw/JlAqNoF2rfrQlrxLy4FUAuhsYCen+tLbQ6E6lcUNgB1q08AqGTgEAZUD6F6Fo3+fYah097AoQZoK58APqAU4btewA9jVIaUCNrPon+4d/Cw+iLeQmg8oEDV6Jz9+rXvDlkAh32yAypHo6GtPQDKXVVCqJEHBOjgmcRnHkD1UuhwGKMypNRBSSH/+O3rx9cu1d2Kb5toQu0zLM3zdk6LVD+hnnmbNkBjCZW9GZoyrHtI/Ku1t2MAlfiEMBoN6KEYozKkPCfpZxTQrglfeSu+L5ZiCnkHScB5swF65tnBEvN0iuV0QvsWkhpABaCyabmyGACocGwiQJVabHg3Eynf6X3IFQPa2gCFUXRFumBAgYnvoNXGD2hch6JeAW01QLmmArSVB66CCFUrScoQgK5FtuIbJ6Bht6AlAKrZtlhtgwCN61DU4mcAoHoO+tcRcT4A0GhC2QnkqR2W+XxQ1oqH7/rYDqAXV/b3j9r22Qf7b3xueWEuQ6mN+lwTumSQ/RYKK6BKqWqx5F0J1gloZIeiBdDGBNRGKB8YMt2Um/C608K0lNjvudrHdOgHdFi44a8/nW1tpmc/vNNevHvn+UdH7ZM3W/CFuwwlVwDt/2lsVzl0USsHoH2AAQBV5hX7Aii1zGcV69ZSOhRNQNVj1XwcgMod/400M6q1AnrY2GKzxWWoWgKpmKcdPyUA3j969uGD9uJ7D8AX7jKU3Bw27AkFswq6BW04z/B5swDqW6ngXANUzHtPBpT8Ewio0pxRc1AAPVcBVaxY5m8fSiWKF1CeI03ptgxNFpntacddFL1473PrC3GXyP4QHvkpPuTV8nwg+Vk91scCWR4tJD62PdnHnUpJRtDkr415aKDFwSY1RtXtakwPD+Xs5Sz6w0E3Dc9A9SE0zHX2MeAzJCCCzva04+cfXW2fvtGzCL6ww9wRVKo7tdYf8xDiHKsKG5YVNepNaoE6Vx5wcKrOez/UDw0z2HsjOjqZab1SOeQDjwgoNVatiqhasUTQ5tBWebC4DPkMyexmmu1px88+uNo1ldwRtHcZSsy/XaMBaivkfYsGnfsAbSwzppwyJr638kYCoTKgalu7AVtxrVKXEGMZvENf1NyNKuJgGVZoQ17N0ts/UNAtHxdXujZ8O7IOKl0U+s5+qryLXquWZbFerPgQqgCqEtlPfLf54DJIE7dSZa7tnbYACofQYWC0aWxVRGEZViChSgA9rAhQymdfzPftduCFuwwlHwAVrlFAE6b/tgrXkOUmD6DyR1p3o+aEw2ALBCPHragKoFp520rdx0a7y29ZqgyEAXoY4DM0kjTLZJEn+0RHI/tB5bM/gtBzCFCp7kDH+t2AAp8qVVBtfhm9YFYvnH4aATQQI81C/8ZaRYyybHX9XAXUbxm6J6niySImoPZzZedLSSIBOozOsLqaB1D9Y3Xapj6/LIXQyIvNM1ayUCe+nWtFsJE8EH2L52qtNxXQiieLxAFq8V5NoQDayKnc/ACASg6aEyDNMs9byCvRSPnEAWhjEHounSt7G8ZrWanewudGW9AvCdB6J4uo6wLmBZTead6oTeMmDtBzFVBgBpZ8yVydELqfZv3VtRyKEabPWW2FvoPdCbBs68JSshrepwM6UyMpXDCgh5LornyAcrta143tzieLeWPMBwBUXDP7HcLCTQFoaGeQkoVkaFiaokkHVKvemq67+dwBQIdiUrm7wXqRQwFlQ5EcUdlADKByZQ+aAKk1mxsfoXJxGdHWBqmTVk7hXgME+S2rgGquKzuATouFA0r+GaaOK3c32GpyEYDSdtHhoVqK2Wb0weaVACp8lo6nr8PPywuoSBkFqHm0XHdXAAVSu9HXCFWc18f+w3xeGKB0Q17FsrVeZBug2uE0bDZsKaJDBVBXK8aYYCk8BGfoqs63jfPpGe0IQPv5SdpXBwGFAqjbst6FJXuvT+8L9HlBgEoVRG0CWxSg6onka8M1fKUXdfTHEUJ1QNnO1jYB0nSeAmrvURQp4wAlE5S07w4DCqV1A6oPNTD3zXWtgDC+dECVFow6gQ2+yDZApc9pzGSNd759KFlwRDjVvNQhbpkAqQwxDT2uVkKVBkckoK0RQg1AbQHUG5t1L6UGmHpkoOUlASpvH2qzIoAkMKDnCqCHdB0uAWijARrYSQCOn7gAFXuUtjX4jYKjkZCoqjTityC7AUAfYtlMBS9cCVnfLUBbtcUdDKjaE0KMSIDSJGpfZRSgat+NHdBGArTtuymhPtUhZVRnEM9DdlPu3GWAWviMBtSTvdfyYgA1rqF3YAMCVO0J6cPwAOiQRLq4WQGVQ+hwdMsI1dx0B9DZALXUC8yjAHAWD6i+yzew4QWUNZDoFZSPHQWofF+GlmB4AxCqOKmM6gMBdASg7H06oCFIIKBEvoENH6CsNc0umGp5MBE2DiBVQe1TyCVAWxXQVuuvYYOmasepomBAeftPdyMV0LAQioD28oRQP6Ct0nclWx5MgJZ188qgueSznkA6Sh1qaERDY3jH7UdcbDkzEaQNQBtrEz7AMhTPDUX0sC4a0MNYQJWDXIAqw/1+QMU+xxTyIcFQEZCQNftrBkAhB/2AisW7IUDtcdAPqJ9QuB6wcEChne67ECBAlcR2QNVmjK+bVUJKiS+6zzKg6j3sTdO0Kp6DfXNUCDINeDf8BgBAHTVJL6D+EAq7vIuANs7lBOAZxVxiygn4HZVKoqWPYGjiiD3Oexx4ChhQi/sxF1tJPYxY6XO09BHdWMveEGouAuCwvGhA3SHU2bk4BBEboEol0Q3osMczAVLpMFDKeDugUdFITd6yUdxWB/TQYjTMsqV+oHSiIaBcrvtkjOlGRgsJOko9wB5Ch6tun1YMFPHNEM7CAI272FpmnG4NUH1WYaRlSw1W6XRAQAc52kkmoFIybSgQsiwTBFYgtAqqF1A1O/lCWgBtRgLKvqYBqP1LhwJqhmABaIuASpKR0MaEtaugtuAby1GaZVHF1T8eAJX2hN/ZxjKYGtAWAJTd22JL57fMgrDpLjPfIqCSGjuh6lXQepiiAQVquFonqVH0efu8uXmwKyEPoKyiImz0wc/OZxigQDdAo2YYbHnpgOqESh9AY5FMyqMuLYa1UADUcBtjbD/Q5yEH2oSxA2qtLYYC2vDhMpGnpw0+DtBDewBFQNtgQJXT61jrpVVCqFHDbbTbxMJuwlH94O0mENDDQ/CTENMSoFKF0VggKsVyy7nX8mvMm3ECLO8aoDIwNkDVKr7rPls1hOo1XPVBI2YPtv9ai3udYUCt4T0I0IbVEjhN5hJ7SZZbsKuqkfpXEVBJammjjsQ00P5wQFu1w8So4Wo7Yqe9t8MNJxZAx3Snyz30xg3bLgUC2uqEyo17BFRSYyNUvurn9hLefSN428D0M0C1g0N91nKwAOrCKRhQnk0gnoGAtkZLniMrDUWEWd4BQBtt2t05/xnb6o/BgGrT9rUahH53qHGuAq51I26JMj9ypAsE1O9AgmVuX7t9i5cG1nbnDgMKEiquuslnKKD6sLI0m0ObZAzN4AkBtLEC6gx4QaYnBlRpcjVs7SDHD2NHASUybteWAdXv6dJr9577bPXefkmNemCcz0xDCAVydiSbH9BWDqK8rwABhaUFm2FGeiO2mEi8bSMABTgZ8NSGZxIB5YQa+dYAqNL+QkCt0toTDVsmi3ZUyjekNexGuWDL9pLWHD+M81n2iNmSTDonHIWZTuMzElDW0arSiYDq0rogtfnp0pWinemRgMLnQAEU7hEKBvRQANq0osHhSFYOoMNo7fC/Ld/lABrw2B5V5Ioqm80px5Nt8k/YjfARtm2PEWq42YZ2UUc7LXztK3Cnw7OMej5PUx7TZFieWNKzmqjv8MObnKoRUGinZz2BRh5j0wpMOYICg4feCApPz22k3CxzeAMjaMvbGqx0bPhye45kRUTQVjTvWDC1d4JaLe8KoMMtcK0NUIZCLKAgoY0CqK2iGgpoywbJaQHJ65/VASr/asMtI6AmoDGW4REd7aokLXPELTUsE7VB3LhPfbmAxlreIUCb4TdsAxQsicPuEmMmRX6t2Je6BoLinNRj00jOW4SAchci3M2l6QBNqyk2w00SwxVQrop1kDsMUPHCSkh3TS7YdBqf0YBK7iKgVtHo2HgAjVlPQDXOagaGRTv2QZaVTEQY8lVAI03HKRJQyXME1C7eknYCahmcibhLrJHjHb806Yt0aLmEXeYE01FCQL1KAJRKxDm521sCFDyBIYAOPT8KoC1tdlkTxlEkflABB5cCaIuAMoUBeqgAKpeZYAM+2DKrHoCA2lNFAxp+cBmA9mr0SBBneZcAbfmUGghQ6+Bh6E04zXC3rtxWGjerOFkIKM891t0MSge0lQDVWh3AfOIYy3y6o97b5JxztDOAGu8iLO84oEPHjZ2k8LvETEDdt1HsHqAJlncN0EMZUNGz6Ji9FnpFDqVZR3J2du0GoCMt7xag9DbJ1gDUNb0y6i4xBVAPnwhoiOUdA1SZdTEA6pxeGXUTjgxolkU6EoWAMlUHKH8irDzW457+G3xFmoYvJEO2ci3SkSYElKk+QKX7s4fNQ9ctuOFXpFHnHOVZpCNNCChTdYASHYo+ec5rFkDJ2ci+SEeaEFCmKgFlQVO8ywVoKw2gBggBDbC8k4DKd8Py2ZUZAQ09FgENsLybgApE5ekjsCItI6B5Le8qoFwIaOGWEdDGA1WN17pKpxFQSAho4ZYRUAS0aMsIqO+IGq91lU4joGmq0XKVTiOgaarRcpVOI6BpqtFylU4joGmq0XKVTiOgaarRcpVOI6BpqtFylU4joGmq0XKVTiOgaarRcpVOI6BpqvR39GYAAB2CSURBVNFylU4vB1AUSpUdlmIiqPr72/SyGWCfuA6xWpbtO5JbP95Y5HbB72ecPXtqc5dpP852qNeW0FxjBAX3IqAIKCAE1JYFAhqVLwKqfDocFJIfAtqWBOjjt/aoXrg9CtCLK/udrrKtJ1etB2rJ3vt8eP/sg/036NaTztR3HnCXwYQI6K4A+s7tk+P3r/evowD9XgfUsx/eoRsSdh4JlJ9/dNQ+ebN/e/9IdhlMh4AioIA8gHaMXfz5j77zgADWxcMuCN6/SqDr3r9+h+1pn+7LL88+fPD09R7r7h210j7/+I7sMpgfAoqAAvIAevHunYsrRz1qHM0P/9eHD0hsfPrG53zPA+mlj5bPPyJlOwm7NAR3JO/v90G07/XyP+CRfWXrp8NBUY+N1O07kls/tgHqyS/YozB79tTmLtN+nO1Qry2HTAdoXwc96kHlqPUQdvVSGhfZHlYN4LUBVsZ3XHcIs70d51IUxQgaYNebwJLa3GXaj7Md6vUsEZS99qiRKNiV3QQ2WiUd9lwh//IXAqgeQXsN9VAENMCuN4EltbnLtB9nO9TrbXczyYD2qH1It+//xzd5BP2Qt8t7gvnLk6tGHZQmREBdR+wMoI//6NPu3+Mf3M4IKK+DdgBevPd/P75D6qDdfrqHUCleJBCff3SVteLJ/ue/wG4m1xE7A+jJo1dePLn1O9dzRtCWteJfv8OaR0MrnsTK+7T5fn9oxXMTtB+UGHiyT4t/6jKYHwK6K4CenDzcOxhfxCtK6ge1CQENsOtNYElt7jLtx9kO9ToY0MdvZYmgqpJGkiwKAHTdy2aAfTIcYj/StCysu3KwO7C2CDxSvLd/i+G9z56eRt4FpNP2WG27z4NdWr7rdUwrPkcddDohoIbXuwQoIARUT4+AqsfBuTmFgCKg7jTyrqoA7aczvXB7TkDJKBTtbFLH6ZnLYBoEdEcAPb5GmvAPf/fT+QAlw0dkwIn2UT15k79wl8FECOiOAPr4bdKAf/Rq7kbS/f39/TeHKUvSbKZ+uhN9y4aQnrI5I1SsQ1WMKSGghte7BOjJo1cuaT2hmSLo84/vsClLYjYTGVu6csSnOrFBeCIxCM9CJ30JnM3EvrL10+EgeTtY0kmNdsAGKHikeA9aUt/77Olp5F1AOm2P1bb7PNil5Wu1scVG0pOrHDsxFt/t6MdC2VSntp/G1NJhzpZu9lGVvfTCCGp4vVMRdCpA+y54OmWJ9sYTMruo2gPKJjbxCPrsA9Gxr0/HQ0CVbzG83xlAj691rXi5jZQH0GE+JynVjQhKoyerg7IoysVqozGzmRBQm1vwrpoAPb526fj963ezt+L7wU42ZUmZzURnk1zlU+5amU82Z1lMXe5dBu0joDsC6ON3bneAStOV8wDaF+L7V+8DrfjvDTuYyD2c+/tH0jSm2NlMCKjNLXhXTYAeXzuYJILmEwJqeL1LgJ48evXn1yaog+ZTAKDtqpPVAPvIcYTDclAObvMrUx4XwjwV5uKXoAMc0faE+pqYs23ZvGWOxSOgsUJA8wkB9dpdNKAP9w4e7u1dQkBhy0E5uM0joEDOwYA+fvv68bVL2VvxkKRbNlWJRZmGd9KxCKjX7sIBffTq7fyTRQDZABWLMg3vnsZNt0NAY1UPoCekfO9iaM4i/tmH/531Y5JBTjK8eYUtOtLfNU/HOhmBF1eOxA3x/N3913+JEdSrHQF0gkbSsw/e+Pzpd/gyYBfv/R8y4bOnkwOqzGYSS4pI7yiggbOZTvurZP9QfkmUMwe3eQBQX2bBLgWZc6Q1dxnW442H5Gz7eEuAHvGx+CdX2R2eXXAUgLLZTHw+6DCyKS3PhBHUqx2JoBO04nvG7h/d399/s19ZhK3SIAGqzGZyRNDeZTAPBHRHAJ2iFU8YYxH0+ce/fO9zElGVIl5aTgSsgyKgIdoZQLO34p998OYwWYkvv0iWDqVl+xO6rq2YzSQWZRLvEFC/dgPQSVrxP/wPw2yk/m64J/v7/+RHfLrSv/zwgTqbSVqUCftBaQqvk6rdRQM6RSNJrPKZQQio1y4CylUqoDlVoeUKXd6xySI5VaHlCl2uE1Be8xSD8y0+TBZlaC5A+Qi89MSkFh/HPa/pbVsuOYIOI/DqavUI6JymEVBZfNmbYUCpD+i5RoHHPfDH+7wgx3OaNI3ywzQ8Ju1G25fLvD9ry4dVABpw27H28wtapjpsLWtbyPAu221fgvxXVPfY669yrarNDG9S4pxIq+zSt391L+MK4LLdzTIiaO8ydKQOaMhpHAXoRr14wAG2jzmfAlCPpVBthLkpAKVHTAXoryyL1PeAAk84LgrQ+Dro/IBurB/XAuhG2zExoL4ISlYEVaaIFASoGJLvXYaO1AENueZjANWLP+CAbQO6kczVBCjLuVpAlSH53mXoyDkAdeZRGaAb0xMNUHbEbIA+eq1AQEEhoB67eQDVQyoHNFN9xMjaByhZWVlZ+BsBBS0PGbi5clRREVAwa28r/uHenvL4rpoB9Tax6VFB2YHnTa+fQQfMB6itRRyQuGBA7UJAzaTpgAqOEFDZMAKqK7B7vBZAJT5HAGoAWQSgrB8U7gWtFFD/eURAodRbB5Tn7I+gpB2PgHosSxm4snC0oRBQOGc/oLSTCRhVQkDNtAsDdGO6Uh6gAtPj96/LfaIIqJHUxxUCGp21E1DpyR4VABowgevevXveaWEjJo4R+/dceWzsn/K0snJMYduMsbcxk27UbeCIPOKGLR9/i/JJ7jKm69JXACi0MyWChsUCRwS1G4iMoDmi0sQRVJojmDeEhkRQVvsc/kVArZaFfQQ0j0IAxQjqUI2ARtuzA8p3TAXokHNoHXSHuplmAVTiKCugCp+LA1Ruxf8R4fT4B1tYYTlR4wHdsIPqATRgXGxXAD159MqLJ7eUaSMIqGEAAc2lIEC1znn1afEVAuqdC8eOQkDN1EUCenKrbyS9SMv4t6qPoAjowgDVu5lqr4N6ByLZUamAmgPX4AEIaEzOod1MS2jFI6ALA7Qr4xfVzbSDgKp81gOoyDi4Fd+3mJSpoXMBKu7lJE+Q/074ffEI6IIBPb5GmvAPC3hevLSm3f0j2WXoYAQ0E6DG2GYRgN7d2zsgt3We0Ls7yUPj528kifVE2BNCuMvQwQjokgElT/Z47VM2o/7RK5e0ntCZABUrMvWPUeqDKF/d7vvOv829P7x3794f2D8nr5s/vLfx2HHb7/42lmM2/ecbZ1rlz+4rtef5/PT7myh7xt8fiLT8O23Ubclv8Hsl/gm/Lcfwbib6f1GNJOkxc+/ekaLo6AhKZypvAkNB3ggqR7rwCOqdW60F0GkjaM4QGljE37p0cutAKdYLAFRd007UQwsC1GZhY/10S4DGLlBjAqr/CB2AjuE1sIinQ52XWCtJ73KavQ7aCwF1HTA1oMPmLICqrfhLx+9fv1tEK56vaUcK++e/yNbNhIC60kcDOmb5XSnfiJvmOkDzPqszUeKBc0/2pQfReQG148E+R0Ad6UsEVJ7NdHztoJAIahMC6ja7QECV2UyPXv35tSLqoDbNDijQ5IWPCAcUOFTeUzKggd3J3nxDZzOV04q3KR+gQad2NkA38HtXhqmAbkxPIgAdQWggoAubzeQFtP+oeEClfbsOqDKb6eHewUPe5YSAIqBlACq14t++3gXUIlrxFu0ioN5W1E4B+ujV2yVMFrGpfEA39k8RUFu+IeuD/ozETVK+00opAqpbVuwXBKjO59IA9QgB1dNvB1Cxs2BAQ0+jN9/dAVQ7tab6y72RTr4zOyegcB45AFUu/K4DqtwXX34r/tStjW+dwA35RFogMXY9Qe9Ch47VGaHFF8FDlRUkN541D02rcd8J+Ebqcosbq/GglS5D8rUcssBWfMkRVAl1dUTQoT5kj6DJITSliK+/FT81oAoNCOg2AF1WKz4WUE8vOALazg7objeSPFd/O4Aax8qAentycgKqt4rKAXQpk0V8gNLLvQ1A4bhYP6CyN1sBtL/LY8+6uMhyAWUnf4GAxjFTOqDDdLu/XgCg6pkFVA+gUn1wkYAq2fqL+FvLeBQiArp9QBMJDQS0f2xCV8gfwHguE9CNfPKjANVggNJmAFS57j5ADT5tgNo6LHyAbmTLirMbOU2sQiOo/UnxCGgKoA4PcgJqUOIBdLMBv+lGN1AeoCdkvRsHo8sG1BeecgKqpt0uoJayeKMBWCigJ6QpX1odVCy/KN61PkClL+0ozzYKoM7zGwMoVH2zp71nNxQE6EY92A2ojSQC6MYEVD2NRQBaXBEvll+UFmJs8wLKYmkEoDoMKqDaxU0GdKPsBAEV5bXJpx1QKFJDP7lIQAMIdRY1v6oRULH0jboIjhNQfxObtY+HQ+IA3bgAZRNNLYBuNhsXoErTWLruNBkEqBRgdemAipzBqoThx0bZlrdSAYXaZ5UDKhYPE+/48ovAzC1U3QqdblcOoGL5RfGOKOBBXjlVo+UqnV5EBO1dhg5ezhUp3DQCOshaB0WhVM0DqFh+UbzrAYUOXk7IKNw0RlAhsfxiRD9odtVouUqn6wPUIgR0PtNrBNQvBHQ+0whogBDQ+UwjoAHy3RePmk7r9bZzrBFQaGeNca7GCLrGCOoVAjqb6fVNBFRX30Ef+bTjrKrRMgLKNTmgT3swI592nFU1WkZAuaYG9P7rv+wiaOzTjrOqRsvTAXpzPY3ltlJAWz6QpD3tGDWL1jdubLsZXwWgsU87zqrJLE9YWmIE5dpSI4ko4mGyWTUdoOttX+zRQkBNLRbQ9c0bCKisigGNfdpxVk0I6HRXexqnOz7nB/TxW+SRneWssMz7QSOedpxXCOigMgB957+9cLsgQE0tA9DuYt+Y7nIvGtDbj98u43nxFi2jm2l9g2jrcy9GaT2DxxCgJ8fX/lHJgEI7a4ugJBjdmC4gTej0lqslIKAnJ3dfQEAntYyAGqq0FW9qUYBORCgCyrSlVvzybppDQA2FAlrWk+b62Uwxi4dl1ySWyaWmgE5D6IIBLetJc3Q2U8TiYfmFgA4qBdCinjTXTxYJWDysLtFOpsp6mmbpGYOK+KKeNMeHOidYmyksFtQVQZm1CZ2eO4KW2EiaaPGwiQF1mO8vNQM0L6FshhQCyrSlCcvT1EEXCCifbrRkQPsnyyrL1c8O6ESLhyGg0cYLAPT4Gnle0kP5oYizAzpRP+jyAB1mc8Q7HeAFqzhvd4IL1Irv/i2nFW+qfkApnwioqtAi/tErl0hnfSlFvKlc3UwTL+PiMC91MuXtuBkx3SjgbKzn6BcrvpFkKlcEDbwlKDWCOsyrETRjSFpzcwkR1O9FIREUAR1t2Wd+KkDXN5MBDbjbiFec8wPq6hozAe0fHq88OB4BhdOnmmd8VgDoWjtkKkDX9oUdgVY8GUS6W0wrvtckazONBNSXPBzQbJe8YkDXwYDSaSKlTBZhmmRtpnXYqU4G1Gq+UEBNN9SvMBmg5Mdxs+oIOs3aTOMA9Vbatg/o+ma1gN4MB7TEOug0azOtR3WYeJcpspvXepmy9dysR1jr067XameT+h3HmA/I2/JhFa343Gsz0RgwbQS1f84DqIigfkeCPF0La0kR1PBE+Q6i6yF3CGU1k9q7maKWvvGUvvTfpQJqLS6Dkmo719ohswPazxVRZ4vUCKizCdN/FrrOEHze1j6utg/oWjKXDKgE5HpLgPKqc1QEffRaSY2k6LWZ3PCtNUDdJ7xCQOPXQYYAhbcnAzRuJKmwbqbYtZnca7RkAHTtAbQPP/DHggUBqK8PMqTLVuIzniE/oFLXg2p89CqSSYAWWAcdVACgYJPCOAD8VOLIA6h04UEG1ur7VED5ybAAOpwkK6AjIyo3XHM3kyrSzfR959/6xu/fuHHjm7bP1zfW3ev692+s++1vstfwP2q/+1tbjln3n6/BvHla5c/0dS2nX0PfRd73zfXaY48cA9pZ03NwQ/tO2neU/V5rfkafv8H/def3mtm1HAd11B+/f72sjnpV3giq157kj+jn61aKoJ4QYP6w5coeYH44AnRACnNSBIU6yZVo5q4DKNGzN20e34/X2Drjza+kteuVirO9qe+QfkyXseJ2xFBnB2hhdVBFPkBd5a8K6E1p0yrjvMmnFQbU7oFySQIBXdsANfooXYDafrW9aeArqYCqFedMgKqKuOWj6gi6BqpTQus1D51r6eQPIDgtcxPKaRVBjptvdUDlQ6yAGqhLcAwuar3oRnXRASjY0ck+WI8GNIBQvRpt+Bw+o/7Vn18rrQ4afk+SfqqBCr0EKAulAi4VAdVyayKmAbrWrqYaoPUyzQWoFO9oMuaiUqxHAGr91dLfqQ9QrWVnVi7WrYmgnhH4DRMANTU7oOFrM+nhTTstAtC1dIjgVJsdsVYs93PCjPM6BM01DKhUVPeVQJkizVnZT7FTADp4KnIEvjQzbcVBDvXD71Q7a3oCvevBrFystY5f89euXwldNQMafF/8GgKUxR0yE2LNo8XaAHStnuT1sHHKYiu1BsDAwNVis2SdUgyEOc2MkATo+ubQuBk85T+DNfSlmWkRXs065lqK6sD3WauFvvqr9AEqfj30lEgZgd9wUM2AhqzN1PPXz8dRdcO5SbfZP+Q/qwnXx8KIxYkQgcngHMMSjnDnhjt9iMkba9V77zcBr2ols5lC1mYyohATDyAiMqofiygnNWjlCHGDR4f1zbVekRIm+kAt1UNNN8zdSsiA+waGHKWaghxMbSMSpyKsWsa0HH1x6pfQHD9tRcyGvpQ4HdRJrahyZLuICNq7DB1yajldvPVia2fKl7uV3w8HDIC2a73NJeVg23LJHP0yAJWaWMPXU76Q5ZudKrUE6Ahn69vR83bKc7UnbkVBL/382Zm151sxoCF1UGdPh+OE84ay2KFez/UNfws1UTZAga4EQwJX8IAB0PXacsjaFgFduQ5O20oTPQ+lSIJKKMOyrioADVmbyX26POfS8TEFNCIuhmsMoF7TQ73FZsMeAj2W+8SWuKxnsSOAzrlG/fae+DrU1jLkeOouwml2SfnwXregnw4rnobqiNoegC1rqgNQRVteYXlrK71kXlnGtwzOuFuyAn2g/7AmOs0x8pnzNQIK7ZxujfqtRdA+1qSFNci0PVQNuSVajtRafWet+C4ngkI7K3uIAmg5rGIXatoLe1peY06HuzaPgKZpi5bzBesgQFMtJ8udY82ATrL0TaBqtMy6093HbB/QFMt1ADrJ0jeBqtFylU5XDOg0S98EqkbLVTpdJaAXV8iaN8/+HS/il/IgL1SoygaUDMBfvHvn4p//K3npG9SO6+/+HW3HbIA+fbO9v7//T3s4o1YWyagaLVfpdHgRf/dSKRGUqIui/ep2/5oA2v9e5i51UFtU8YCSiSL/7x//l/Zv/uI/sT0YQeczvSoigpZTByXTRK62dOmbf49F/PymEVBNF1eGHlCsgxZgugBA2fKL8gKM8wHK+Ixe3S6narS8ZECLiqBkiJN0hMaubpdTNVpGQLlwskiRlhcNaBWr26Hm0Wq17RyreAyNKoyg85nuAJ3IcngjqcQHeSlCQGczvbo8P6BlRVA6WWTOm+aqtLxkQIuqg7LJIuGLh02gGi0vGlBTs04WIT30wYuHTaEaLSOgXNuZLBKyeBhqC1q9PHsr/uELt2+VU8S3dLJIyOJhkzlQo+XlRtDj9/9tUY0kOlkkZPGwyTyo0fJyAX38zs+K6maig/FYBy3E9PyAHl87uNVH0BeLKOLZZJGQxcMm82EyyxNe6+kAvbyaxnIb2kjik5nKeJgsnyyyyH7Q1XTXesGAQiptJGnbDcmJNEOTeKxWL2/d5xoBhXbWGEFf3nY0Gq1yIuijV4so4kEhoH4tHlCln2lWQPvW+xLXZlpdfnm6q71gQIu65aNtn/ZgLnFtJgRUU5WNpPuv/7KLoItcmwkB1VQloLSI7xdu6IPogsbiuxZxbc34OVyuAtCLd+/IazNBh9UZQSeLR9M43QVQjKC6hiHOpd0Xj4BqCgWUtZKkoSQEdAJ1FxsBVRR8y8dB//pQ9DPNDugSF25AQHVF3TSnzGeaHdAlLtxAAZ3qei8Y0NIiqKlFtOJJg/jl2trxZbTiWR30d66XUQc1tYgISoJRlRF0uvHZSlvxphYF6ESEIqBMW6qDLm8+KAJqKBTQh30Jf1AIoP1Y/PLuiyeXGgFVFQboQ3ZD5y0J0dnH4pd3TxICairsprl/Nrz9r+V0M010X/yMLWjeiK+rHb+awd8q6qAT3RcfFgsmjqDThNDlRlBzNmgBgE50XzwCGqkCACW1z0v8n2IAnagOOjGgLvNVAkqdnhvQ0tYHJWBOdF/8fID2lxoBVRUVQYtZ+mbKftAyAM1LKDO2ZEBPylo8zFSuVvzU6607zEuN+MzN4im/1GqOXofiW/GmckXQwJU9qoqgK2Yt3ukAL0qJoCdkSlMxrXhTlQDqMj8hoNTcogG9pUxlQkDjLXvNlwio3w3W9bDdSdbAffEH+q75AZ1k4Yb5AKV8TgDoMKN4wYAWGUEnWbihFEAzXvF0QFcBXpQCaHl10GkWbgi5JmmWqXkENE6VzgclmmbhhomXP3SYV3qZMnbcjOgHCllYcTXH7JYqAJ1m4YaxEdST2m6eBdD8EXQ1mEuIoF43eMsufwRdtfbH1JqA3t3bO3j89vWSAO2V/b74kYD6qrBLAHSlHTIVoCvyf2gr/u3rj177tPsfAXVb9iUPBzTbJR8HKOCG8iOcDFDy47gcDug7t+n/BQE6zcIN4wD1lYmOz6cCdHV5HKCXV6uVHjNX2iFTrDZB846ZLHLroLAVljMv3NCf4dClBLcAqN+RIE9XwlosoCvQE+U7iK6HSQC1PeDGtoBtMfNBTYW04t0tzf7TkQ8E8C1iYDevteGDGsZBno5YDGIFuaLe4QEekkPuzoEqWvGqiDv/Rv87VbZX3+jKKuMY/kc/W33jMjtmZTmO/p3CNi5fHtKDf6vL37DY/e3LJG339zJ77aKHI//e1992f67a7fz6fsDxtrRDnup3XNHPX7Z+r9Q/lrfF50oBNaSUDyv3IkIrtYj3NMfBkme1chfNq5W1iF8Nxako4sEWtORXyKCXsEsqk/7j1cSmKyt1W6qXqMZXI5/3xA1XukY9VdSE5dVKPdOyGJp9x9sAqLtSZZ631Qqusomqot0DGSMnoMpvDHRRaWHLdi9Dc476BhDEEv+1aq7oX1GuOOtt+7AaMuTRSjhe80hSzMINVnj6D8lOSuYQZQWocOb6eVNREAy1giMl+AxQrFYKCAqgRsxbrYSBwUU1WIkNjU4AUGYOiK0rsktOrwNKT5IS9o3Op/6reXrdzIxVxd4Xf/yDciJo0E1z9CQpp5p2m7DLyn6t4h928gWoK+VQJmaZmTdZYDmsLq94sS4dMmTJ36gUqYbElxFfo4eHVxdWIju6xd4YeCq9lfrvYvhi9FO6S/1G0JdQnF71P0g5/onvyU/VajhtzEcZYj3iXw6OoIWtLEIVsnDDClW3LG18s4h/9EpJazP1mmjhhjDVaLlKpyuug060cEOYarRcpdMVA6rVQVEoVXMDqi7csGU5vn25qtHpSXyeox90y6rxWlfpdM2Azqkar3WVTiOgqN0TAooqWggoqmghoKiihYCiitYyAb240t+Gzzq31K1iBTrNXkoV6DOdvZZJiwSUjKpevHuHTfJTt4oV6DR7mds3m0CfW3ILGgLq0lPC4f0jNsCqbs3tm1Wg0+xlZtesAn3uIumf/wgB9an7OUtTVNStYmU4Lb2UKtPn5x//DyzifSKj/2KSn7pVrEynxUupAnx+chXroD49++CqNMlP3SpWgNPDS6mCTzQC6tHFFXKCeK1T3SpWkNP8pVRBPpPFivf3c/2sFgkou6pskp+6VaxAp6vgU/O5xW4mn+hv+Ih1z6lbxQp0mu8sVPCJRkBRuyMEFFW0EFBU0UJAUUULAUUVLQQUVbQQUFTRQkBRRQsBRRUtBBRVtBBQVNFCQFFFCwFFFS0EFFW0EFBU0UJAUUULAUUVLQQUVbQQUFTRQkBRRQsBRRUtBBRVtBBQVNFCQFFFCwFFFS0EFFW0EFBU0fr/SN2zH2DH2+QAAAAASUVORK5CYII=" alt="**Figure 6:** *Top*: Weekly all-cause mortaility in Germany and expected mortality of the normal and three excess states are shown. Weeks with excess probabilty&gt;0.5 are shown in blue. *Bottom*: Weekly excess probability." />
<p class="caption">
<strong>Figure 6:</strong> <em>Top</em>: Weekly all-cause mortaility in
Germany and expected mortality of the normal and three excess states are
shown. Weeks with excess probabilty&gt;0.5 are shown in blue.
<em>Bottom</em>: Weekly excess probability.
</p>
</div>
</div>
<div id="a-short-overview-of-the-statistical-model" class="section level2">
<h2>A short overview of the statistical model</h2>
<p>The <em>excode</em> package combines Generalized Linear Models (GLMs)
with Hidden Markov Models (HMMs). The GLM part of the model allows to
use regression models to model seasonal patterns and general trends in
the time series. Besides seasonal patterns and general time trends, an
algorithm for excess count detection needs to account for excess counts
in the historic data used for model estimation. The HMM part of the
statistical model used in <em>excode</em> allows to explicitly consider
past disease outbreaks in the model. The HMM separates the time series
in two (or more) states: the normal state and one (or multiple) excess
state. In the normal state, observed case counts lie within the range of
what is normally expected in a certain time period. In the excess state,
case counts are higher than what is normally expected, i.e. there is a
potential outbreak or excess mortality. This is in contrast most of
other algorithms used for excess count detection, which either do not
account for previous excess case counts or use some heuristic for down
weighting past instances of excess counts.</p>
<p>For simplicity, we consider a two state model with
<code>normal</code> state <span class="math inline">\(N\)</span> and
<code>excess</code> state <span class="math inline">\(E\)</span>. Each
position <span class="math inline">\(t\)</span> in the time series of
length <span class="math inline">\(T\)</span> is in a state <span class="math inline">\(s_t \in \left\{ N,E\right\}, t\in
\left[1;T\right]\)</span> , where <span class="math inline">\(N\)</span>
represents the normal and <span class="math inline">\(E\)</span> the
excess state. The sequence of normal and excess states is modeled by the
HMM using initial state and transition probabilities (left boxes in
Figure 7):</p>
<ul>
<li>Initial state probabilities <span class="math inline">\(\Pr(s_{1}=N\bigr)\)</span> and <span class="math inline">\(\Pr(s_{1}=E\bigr)\)</span> give the probability
that the first time point of the time series is in the respective
state.</li>
<li>Transition probabilities give the probability that time point <span class="math inline">\(t\)</span> is in a specific state, given the state
of the previous time point. For instance, <span class="math inline">\(\Pr\left(s_{t}=N\left|s_{t-1}=N\right.\right)\)</span>,
<span class="math inline">\(t\in\left[1;T\right]\)</span> gives the
probability that the time series is in the normal state at time point
<span class="math inline">\(t\)</span>, given that position <span class="math inline">\(t-1\)</span> is also in the normal state. <span class="math inline">\(\Pr\left(s_{t}=E\left|s_{t-1}=N\right.\right)\)</span>
gives the probability to transition to the excess state at time point
<span class="math inline">\(t\)</span>, given that <span class="math inline">\(t-1\)</span> is in the normal state.</li>
</ul>
<p>The expected case counts at position <span class="math inline">\(t\)</span>, <span class="math inline">\(\mu_t\)</span> are modeled using a GLM using sine
and cosine functions to control for seasonal patterns (which is one of
the models available in <em>excode</em>):</p>
<p><span class="math display">\[
\log\mu_{t}=\beta_{0}+\beta_{1}t+ \beta_3 \cos(\frac{2\pi}{52}t) +
\beta_4\sin(\frac{2\pi}{52}t) +
\beta_{5}I\left(s_{t}=E\right)
\]</span></p>
<p>Here, <span class="math inline">\(\beta_{0}\)</span> is the
intercept, <span class="math inline">\(\beta_{1}t\)</span> a linear time
trend, <span class="math inline">\(\beta_3\)</span> and <span class="math inline">\(\beta_4\)</span> model the seasonal patterns using
<span class="math inline">\(\sin\)</span> and <span class="math inline">\(\cos\)</span> functions with weekly data (52 time
points per year). The increase in cases is incorporated by <span class="math inline">\(\beta_{5}\)</span>.</p>
<p>Based on this model, <em>excode</em> calculates a probability that
there is an excess of case counts at the current time point - the
posterior probability. Moreover, given the normally expected case counts
in the model, a p-value for the null hypothesis, that there is no excess
at the current timepoint is calculated. The z-score is calculated based
on a quasi-Poisson regression as described in <a href="https://www.destatis.de/DE/Themen/Gesellschaft-Umwelt/Bevoelkerung/Sterbefaelle-Lebenserwartung/sterbefallzahlen.html">EuroMOMO</a>.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
