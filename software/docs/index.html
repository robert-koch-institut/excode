<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Excess Count Detection in Epidemiological Time Series • excode</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Excess Count Detection in Epidemiological Time Series">
<meta property="og:description" content="Excess count detection (excode) in epidemiological time series is an important part of public health surveillance systems. The excode package provides a flexible framework that implements well established approaches to control for seasonality, long-term trends and historic events, but also allows the use of customized models. By combining hidden Markov models and generalized linear models, excode explicitly models normally expected case counts and expected excess case counts.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">excode</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="articles/excode.html">Get started</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<p align="right">
</p>
<p><img src="https://robert-koch-institut.github.io/SARS-CoV-2-Infektionen_in_Deutschland/assets/RKI_Logo.png" style="width: auto; height: 60px;"></p>

<!-- HEADER_START: {"lang": "en"} -->
<p>Documentation # excode: Excess Count Detection in Epidemiological Time Series</p>
<p><br><br></p>
<p><a href="https://orcid.org/0000-0002-6107-6389" class="external-link"><strong>Benedikt Zacher</strong></a>¹, &amp; <a href="https://orcid.org/0009-0008-5392-1774" class="external-link"><strong>Ann Christin Vietor</strong></a>¹</p>
<p>  ¹ <a href="https://www.rki.de/" class="external-link">Robert Koch-Institut</a> | <a href="https://www.rki.de/DE/Institut/Organisation/Abteilungen/Abteilung-3/FG32/fg32-surveillance-und-elektronisches-melde-und-informationssystem-demis-oegd-kontaktstelle-node.html" class="external-link">Fachgebiet 32</a></p>
<p><strong>Cite</strong><br>
Zacher, B., &amp; Vietor, A. (2025). excode: Excess Count Detection in Epidemiological Time Series. Zenodo. <a href="https://doi.org/10.5281/zenodo.15322133" class="external-link">https://doi.org/10.5281/zenodo.15322133</a></p>
<!-- HEADER_END -->
<hr>
<p>This repository contains the R package <em>excode</em> with a variety of functions for <strong>ex</strong>cess <strong>co</strong>unt <strong>de</strong>tection in epidemiological time series. Excess count detection is an important part of public health surveillance.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>This is an R package. You can use <code>install_github()</code> from devtools to install this package.</p>
<pre class="commandline"><code><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"robert-koch-institut/Excess_count_detection_for_epidemiological_time_series"</span><span class="op">)</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>A variety of algorithms has been developed to identify events such as disease outbreaks or excess mortality. To this end, time series are analysed to detect unusually large (case) counts, that exceed what is normally expected in a certain time period and geographical region. The normal expectancy of cases in a current time period is usually calculated based on historic data. Depending on the time series of interest, the following features need to be taken into account by a model:</p>
<ul>
<li>
<strong>Seasonal patterns:</strong> Many epidemiological times series that are of public health interest show periodic changes in cases depending on seasons or other calendar periods.</li>
<li>
<strong>Long-term time trends:</strong> The time series may show a long-term increase or decrease in case counts.</li>
<li>
<strong>Historic events:</strong> Events such as disease outbreaks may have caused an excess of case counts in historic data that is used for model estimation. This needs to be considered to avoid overestimation of the normal expectancy for the current time period.</li>
</ul>
<p>The <em>excode</em> package provides a flexible framework that implements well established approaches to control for seasonality, long-term trends and historic events, but also allows the use of customized models. The user can choose between the Poisson and the Negative Binomial distribution, which are the most commonly used probability distributions for modeling count data. By combining hidden Markov models and generalized linear models, <em>excode</em> explicitly models normally expected case counts <em>and</em> expected excess case counts, i.e. each time point in a time series is labeled either as a normal state or as an excess state. A short overview of the statistical model used can be found at the end of this document.</p>
<div class="section level3">
<h3 id="available-models-in-excode">Available models in <em>excode</em>
<a class="anchor" aria-label="anchor" href="#available-models-in-excode"></a>
</h3>
<p>There are five different model classes implemented in <em>excode</em>:</p>
<ul>
<li>
<strong>Mean:</strong> This model does not account for seasonal or cyclical patterns. The expectancy of normal and excess case counts is modeled as the mean of the historic data.</li>
<li>
<strong>FarringtonNoufaily:</strong> This is a popular algorithm, which models seasonality by segmenting a year into a predefined number of shorter time periods, where each has a different expectancy of observed cases. It also allows integration of a long-term time trend.</li>
<li>
<strong>Harmonic:</strong> The ‘Harmonic’ model uses sine and cosine function to account for seasonal or cyclical patterns in the data. It also allows integration of long-term time trends.</li>
<li>
<strong>Custom:</strong> The ‘Custom’ model allows the user define their own model by providing a data frame containing covariate data.</li>
</ul>
<p>All of the above mentioned models use two states - a ‘normal’ and an ‘excess’ state - to detect excess counts. However in some cases it might be necessary to allow multiple states, such as ‘normal’, ‘low excess’, ‘medium excess’, ‘high excess’, to account for a wide range of excess counts and detect all periods showing an excess in a time series.</p>
<ul>
<li>
<strong>MultiState:</strong> The ‘MultiState’ model allows the use of multiple states. The number of states can be specified by the user. Like in the ‘Custom’ model, the user must provide covariate data to control for possible seasonal or long-term time trends. The use of this model is more advanced than the other models and requires some additional steps before fitting.</li>
</ul>
<p>Further descriptions and code examples can be found in the <code><a href="articles/excode.html">vignette("excode")</a></code>.</p>
</div>
<div class="section level3">
<h3 id="running-an-excode-model">Running an excode model<a class="anchor" aria-label="anchor" href="#running-an-excode-model"></a>
</h3>
<p>The package’s core function, <code><a href="reference/run_excode.html">run_excode()</a></code> performs the excess count detection. The output of <code><a href="reference/run_excode.html">run_excode()</a></code> is a fitted <code>excodeModel</code> object.<br>
Before running the excess count detection, the user needs to decide which probability distribution and which model should be used. This is done using the <code>excodeFamily</code> and <code>excodeFormula</code> objects of the <em>excode</em> package. Both are then combined into an <code>excodeModel</code> object, which stores all necessary parameters and specifications for model fitting. In this example, the ‘Poisson’ distribution and the ‘Harmonic’ model is chosen.</p>
<pre class="commandline"><code><span><span class="co"># Use a 'Poisson' distribution in excodeFamily</span></span>
<span><span class="va">excode_family_pois</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/excodeFamily.html">excodeFamily</a></span><span class="op">(</span><span class="st">"Poisson"</span><span class="op">)</span></span>
<span><span class="co"># Define the 'Harmonic' model in excodeFormula</span></span>
<span><span class="va">excode_formula_har</span> <span class="op">=</span> <span class="fu"><a href="reference/excodeFormula.html">excodeFormula</a></span><span class="op">(</span><span class="st">"Harmonic"</span><span class="op">)</span></span>
<span><span class="co"># Combine both in the final excodeModel object</span></span>
<span><span class="va">excode_har_pois</span> <span class="op">=</span> <span class="fu"><a href="reference/excodeModel.html">excodeModel</a></span><span class="op">(</span><span class="va">excode_family_pois</span>,</span>
<span>                             <span class="va">excode_formula_har</span><span class="op">)</span></span>
<span>                             </span>
<span><span class="co"># Run excode on time points 209-295 on Salmonella hadar shadar_df data.frame</span></span>
<span><span class="va">result_shadar_har</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/run_excode.html">run_excode</a></span><span class="op">(</span><span class="va">shadar_df</span>, </span>
<span>                               <span class="va">excode_har_pois</span>, </span>
<span>                               <span class="fl">209</span><span class="op">:</span><span class="fl">295</span><span class="op">)</span></span>
<span></span>
<span><span class="va">result_shadar_har</span></span></code></pre>
<p>Results can be extracted using the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> function:</p>
<pre class="commandline"><code><span><span class="va">summary_shadar_har</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">result_shadar_har</span><span class="op">)</span></span>
<span><span class="fu">kable</span><span class="op">(</span><span class="fu">as_tibble</span><span class="op">(</span><span class="va">summary_shadar_har</span><span class="op">[</span><span class="fl">82</span><span class="op">:</span><span class="fl">87</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">kable_styling</span><span class="op">(</span>font_size <span class="op">=</span> <span class="fl">11</span><span class="op">)</span></span></code></pre>
<p>Further descriptions, other models and code examples are available in the <code><a href="articles/excode.html">vignette("excode")</a></code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h2>
<p>The package includes example datasets which can be used to apply the different algorithms.</p>
<p>The following datasets are provided with this package:<br><strong>mort_df_germany</strong><br><strong>sarscov2_df</strong><br><strong>shadar_df</strong><br><strong>snewport_df</strong>.</p>
<p><br></p>
<div class="section level3">
<h3 id="german-all-cause-mortality-data">German all-cause mortality data<a class="anchor" aria-label="anchor" href="#german-all-cause-mortality-data"></a>
</h3>
<p>The dataset <strong>mort_df_germany</strong> contains the number of weekly deaths in Germany reported to the <a href="https://www.destatis.de/DE/Themen/Gesellschaft-Umwelt/Bevoelkerung/Sterbefaelle-Lebenserwartung/sterbefallzahlen.html" class="external-link">German Federal Statistical Office</a>.</p>
</div>
<div class="section level3">
<h3 id="sars-cov-2-infections-in-berlin-neukölln-germany">SARS-CoV-2 infections in Berlin-Neukölln (Germany)<a class="anchor" aria-label="anchor" href="#sars-cov-2-infections-in-berlin-neuk%C3%B6lln-germany"></a>
</h3>
<p>The dataset <strong>sarscov2_df</strong> contains the daily number of reported <strong>SARS-CoV-2</strong> cases from March to July 2020 in <strong>Berlin-Neukölln</strong>.<br>
The dataset was downloaded on <strong>2024-10-31</strong> from <a href="https://robert-koch-institut.github.io/SARS-CoV-2-Infektionen_in_Deutschland/" class="external-link">this source</a>.</p>
</div>
<div class="section level3">
<h3 id="salmonella-hadar-cases-in-germany-20012006">Salmonella Hadar cases in Germany (2001–2006)<a class="anchor" aria-label="anchor" href="#salmonella-hadar-cases-in-germany-20012006"></a>
</h3>
<p>The dataset <strong>shadar_df</strong> contains the weekly number of reported <strong>Salmonella Hadar</strong> cases from January 2001 to August 2006 in Germany.</p>
</div>
<div class="section level3">
<h3 id="salmonella-newport-cases-in-germany-20042014">Salmonella Newport cases in Germany (2004–2014)<a class="anchor" aria-label="anchor" href="#salmonella-newport-cases-in-germany-20042014"></a>
</h3>
<p>The dataset <strong>snewport_df</strong> contains the weekly number of reported <strong>Salmonella Newport</strong> cases from January 2004 to February 2014 in Germany.</p>
</div>
</div>
<div class="section level2">
<h2 id="administrative-and-organizational-information">Administrative and organizational information<a class="anchor" aria-label="anchor" href="#administrative-and-organizational-information"></a>
</h2>
<p>This R package was developed by Benedikt Zacher with contributions from Ann Christin Vietor <a href="https://www.rki.de/EN/Institute/Organisation/Departments/Department-3/Unit-32/unit-32-surveillance-and-demis-focal-point-public-health-service-node.html" class="external-link">Unit 32 | Surveillance</a>. The publication of the code as well as the quality management of the metadata is done by department <a href="https://www.rki.de/EN/Institute/Organisation/Departments/MFI/MF4/mf4-domain-specific-data-and-research-data-management-node.html" class="external-link">MF 4 | Domain Specific Data and Research Data Management</a>. Questions regarding data management and the publication infrastructure can be directed to the Open Data Team of the Department MF4 at <a href="mailto:OpenData@rki.de" class="email">OpenData@rki.de</a>.</p>
</div>
<div class="section level2">
<h2 id="funding">Funding<a class="anchor" aria-label="anchor" href="#funding"></a>
</h2>
<p>Benedikt Zacher and Ann Christin Vietor were supported by BMBF (Medical Informatics Initiative: HIGHmed) and the collaborative management platform for detection and analyses of (re-)emerging and foodborne outbreaks in Europe (COMPARE: European Union’s Horizon research and innovation programme, grant agreement No. 643476).</p>
</div>
<div class="section level2">
<h2 id="collaborate">Collaborate<a class="anchor" aria-label="anchor" href="#collaborate"></a>
</h2>
<p>If you want to contribute, feel free to fork this repo and send us pull requests.</p>
</div>
<div class="section level2">
<h2 id="guidelines-for-reuse-of-the-code">Guidelines for Reuse of the Code<a class="anchor" aria-label="anchor" href="#guidelines-for-reuse-of-the-code"></a>
</h2>
<p>Open source code from the RKI is available on <a href="http://Zenodo.org/" class="external-link">Zenodo.org</a>, <a href="http://GitHub.com/" class="external-link">GitHub.com</a> and <a href="https://gitlab.opencode.de" class="external-link">OpenCoDE</a>:</p>
<ul>
<li><a href="https://zenodo.org/communities/robertkochinstitut" class="external-link uri">https://zenodo.org/communities/robertkochinstitut</a></li>
<li><a href="https://github.com/robert-koch-institut" class="external-link uri">https://github.com/robert-koch-institut</a></li>
<li><a href="https://gitlab.opencode.de/robert-koch-institut" class="external-link uri">https://gitlab.opencode.de/robert-koch-institut</a></li>
</ul>
</div>
<div class="section level2">
<h2 id="license">License<a class="anchor" aria-label="anchor" href="#license"></a>
</h2>
<p>The <strong>excode</strong> package is free and open-source software, and you are welcome to redistribute it under the terms of the <a href="https://www.gnu.org/licenses/gpl-3.0.html" class="external-link">GNU General Public License, version 3</a>.</p>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing excode</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Benedikt Zacher <br><small class="roles"> Author, maintainer, copyright holder </small>  </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Benedikt Zacher.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
